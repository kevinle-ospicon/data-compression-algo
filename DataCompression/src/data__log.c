/*============================================================================
@brief A C source for data log definition
------------------------------------------------------------------------------
<!-- Written by Kevin (Phuc) Le Dinh -->
<!-- Copyright (C) 2018 All rights reserved -->
============================================================================*/

/*----------------------------------------------------------------------------
  @brief
----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------
  include files
----------------------------------------------------------------------------*/
#include "data__log.h"
#include <string.h>

/*----------------------------------------------------------------------------
  manifest constants
----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------
  type definitions
----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------
  macros
----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------
  prototypes
----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------
  global variables
----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------
  static variables
----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------
  public functions
----------------------------------------------------------------------------*/

/*============================================================================
@brief
------------------------------------------------------------------------------
@note
============================================================================*/
uint8_t 
data__log_get_payload_len( enum data__log_type_e log_type )
{
    switch( log_type )
    {
        case data__log_type_raw_adc:
            return sizeof( data__log_raw_adc_payload_t );
        case data__log_type_cal_led:
            return sizeof( data__log_cal_led_payload_t );
        case data__log_type_temperature:
            return sizeof( data__log_temperature_payload_t );
        default:
            return 0;
    }
}

/*============================================================================
@brief
------------------------------------------------------------------------------
@note
============================================================================*/
data__log_packet_t 
data__log_prepare_raw_adc_packet( uint32_t timestamp , uint16_t * raw_adc , uint8_t sample_count )
{
    data__log_packet_t packet;
    
    // Prepare header
    memcpy( packet.header.log_begin , LOG_DATA_BEGIN_MARKER , LOG_DATA_BEGIN_MARKER_LEN );
    packet.header.timestamp = timestamp;
    packet.header.log_type = data__log_type_raw_adc;
    packet.header.payload_len = data__log_get_payload_len( data__log_type_raw_adc );
    
    return packet;
}
/*----------------------------------------------------------------------------
  private functions
----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------
  End of file
----------------------------------------------------------------------------*/